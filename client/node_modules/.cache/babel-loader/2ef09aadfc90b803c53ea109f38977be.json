{"ast":null,"code":"import _toConsumableArray from \"/home/jean-francois/Documents/Web_Test/NRT/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/jean-francois/Documents/Web_Test/NRT/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/jean-francois/Documents/Web_Test/NRT/client/src/JS/File.js\";\nimport React from \"react\";\nimport \"../CSS/File.css\";\nimport { Link } from \"react-router-dom\";\nimport { useRef } from 'react';\nimport Tweet from \"./Tweet\";\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\n\nfunction File(_ref) {\n  var _this = this;\n\n  var email = _ref.email,\n      firstName = _ref.firstName,\n      lastName = _ref.lastName,\n      _id = _ref._id;\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      tweetList = _React$useState2[0],\n      setTweetList = _React$useState2[1];\n\n  var tweet = useRef(null);\n  var token = Cookies.get('token');\n\n  function timeConverter(time) {\n    var date = Date.now() - time;\n    var min = Math.floor(date / (60 * 1000));\n    var hour = Math.floor(date / (60 * 60 * 1000));\n    var day = Math.floor(date / (24 * 60 * 60 * 1000));\n\n    if (date < 60 * 1000) {\n      return 'Just now';\n    } else {\n      if (!hour) {\n        return min + ' min';\n      } else {\n        if (!day) {\n          return hour + ' h ' + (min - hour * 60) + ' min';\n        } else {\n          return day + ' j ' + (hour - day * 24) + ' h ' + (min - hour * 60) + ' min';\n        }\n      }\n    }\n  }\n\n  React.useEffect(function () {\n    var tweetsID = [];\n    axios.get(\"/tweets/getUserLikes/\".concat(_id), {\n      headers: {\n        authorization: 'Bearer ' + token\n      }\n    }).then(function (response) {\n      if (!response.data.message) {\n        response.data.tweets.forEach(function (e) {\n          tweetsID.push(e._id);\n        });\n      }\n    });\n    fetch(\"/tweets/getTweets\").then(function (res) {\n      return res.json();\n    }).then(function (data) {\n      var tweets = [];\n      data.forEach(function (element) {\n        element.tweets.forEach(function (e) {\n          var t = {\n            _id: e._id,\n            content: e.content,\n            firstName: element.author.firstName,\n            lastName: element.author.lastName,\n            date: timeConverter(e.date),\n            userID: element.author._id,\n            liked: tweetsID.includes(e._id) ? true : false\n          };\n          tweets.push(t);\n        });\n      });\n      setTweetList(tweets);\n    });\n  }, []);\n\n  var sendTweet = function sendTweet(event) {\n    event.preventDefault();\n    tweet.current.value !== '' && axios.post('/tweets/postTweet', {\n      email: email,\n      content: tweet.current.value,\n      date: Date.now(),\n      _id: _id\n    }, {\n      headers: {\n        authorization: 'Bearer ' + token\n      }\n    }).then(function (response) {\n      response.data.date = timeConverter(response.data.date);\n      setTweetList([].concat(_toConsumableArray(tweetList), [response.data]));\n    }).catch(function (err) {\n      console.error(err);\n    });\n    event.target.reset();\n  };\n\n  function refreshTweetList(tweetID) {\n    setTweetList(tweetList.filter(function (e) {\n      return e['_id'] !== tweetID;\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"File\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"welcome link\",\n    onClick: function onClick() {\n      return window.location.reload();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }, \"Accueil\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profil\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, firstName), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }, lastName)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"textBox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: sendTweet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    placeholder: \"Quoi de neuf ?\",\n    ref: tweet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }\n  }, \"Tweeter\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tweetList\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, tweetList.map(function (e) {\n    return /*#__PURE__*/React.createElement(Tweet, {\n      key: e._id,\n      content: e.content,\n      firstName: e.firstName,\n      lastName: e.lastName,\n      _id: e._id,\n      userID: e.userID,\n      date: e.date,\n      refreshTweetList: refreshTweetList,\n      liked: e.liked,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    });\n  })));\n}\n\nexport default File;","map":{"version":3,"names":["React","Link","useRef","Tweet","axios","Cookies","File","email","firstName","lastName","_id","useState","tweetList","setTweetList","tweet","token","get","timeConverter","time","date","Date","now","min","Math","floor","hour","day","useEffect","tweetsID","headers","authorization","then","response","data","message","tweets","forEach","e","push","fetch","res","json","element","t","content","author","userID","liked","includes","sendTweet","event","preventDefault","current","value","post","catch","err","console","error","target","reset","refreshTweetList","tweetID","filter","window","location","reload","map"],"sources":["/home/jean-francois/Documents/Web_Test/NRT/client/src/JS/File.js"],"sourcesContent":["import React from \"react\";\nimport \"../CSS/File.css\";\nimport { Link } from \"react-router-dom\";\nimport {useRef} from 'react';\nimport Tweet from \"./Tweet\";\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\n\nfunction File({email, firstName, lastName, _id}) {\n    const [tweetList, setTweetList] = React.useState([]);\n    const tweet = useRef(null);\n    const token = Cookies.get('token');\n\n    function timeConverter(time) {\n        const date = Date.now() - (time);\n        const min = Math.floor(date/(60*1000));\n        const hour = Math.floor(date/(60*60*1000));\n        const day = Math.floor(date/(24*60*60*1000));\n        if(date < (60*1000)) {\n            return 'Just now';\n        } else {\n            if(!hour) {\n                return min+' min';\n            } else {\n                if(!day) {\n                    return hour+' h '+(min-hour*60)+' min';\n                } else {\n                    return day+' j '+(hour-day*24)+' h '+(min-hour*60)+' min';\n                }\n            }\n        }\n    }\n\n    React.useEffect(() => {\n        const tweetsID = []\n        axios.get(`/tweets/getUserLikes/${_id}`, { headers: {authorization: 'Bearer ' + token}})\n            .then((response) => {\n                if(!response.data.message) {\n                        response.data.tweets.forEach((e) => {\n                            tweetsID.push(e._id);\n                        });\n                }\n            });\n        fetch(\"/tweets/getTweets\")\n          .then((res) => res.json())\n          .then((data) => {\n            const tweets = [];\n            data.forEach((element) => {\n                element.tweets.forEach((e) => {\n                    const t = {\n                        _id: e._id,\n                        content: e.content,\n                        firstName: element.author.firstName,\n                        lastName: element.author.lastName,\n                        date: timeConverter(e.date),\n                        userID: element.author._id,\n                        liked: tweetsID.includes(e._id) ? true : false\n                    }\n                    tweets.push(t);\n                });\n            });\n            setTweetList(tweets);\n          });\n      }, []);\n\n    const sendTweet = event => {\n        event.preventDefault();\n        tweet.current.value !== '' &&\n        axios\n            .post('/tweets/postTweet', {email: email, content: tweet.current.value, date: Date.now(), _id: _id}, { headers: {authorization: 'Bearer ' + token}})\n            .then((response) => {\n                response.data.date = timeConverter(response.data.date);\n                setTweetList([...tweetList, response.data]);\n            })\n            .catch(err => {\n                console.error(err);\n              });\n        event.target.reset();\n    }\n\n    function refreshTweetList(tweetID) {\n        setTweetList(tweetList.filter(e => e['_id']!==tweetID));\n    }\n\n    return <div className=\"File\">\n        <div className=\"welcome link\" onClick={() => window.location.reload()}>\n            <p>Accueil</p>\n        </div>\n        <div className=\"top\">\n            <div className=\"profil\">\n                <p>{firstName}</p>\n                <p>{lastName}</p>\n            </div>\n            <div className=\"textBox\">\n                <form onSubmit={sendTweet}>\n                    <input placeholder=\"Quoi de neuf ?\" ref={tweet}></input>\n                    <button type=\"submit\" className=\"button\" >Tweeter</button>\n                </form>\n            </div>\n        </div>\n        <div className=\"tweetList\">\n            {tweetList.map((e) => (\n                <Tweet key={e._id} content={e.content} firstName={e.firstName} lastName={e.lastName} \n                _id={e._id} userID={e.userID} date={e.date} refreshTweetList={refreshTweetList} liked={e.liked}></Tweet>\n            ))}\n        </div>\n    </div>;\n}\nexport default File;"],"mappings":"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"},"metadata":{},"sourceType":"module"}